package com.github.iarlo.livraria.controller;

import com.github.iarlo.livraria.model.Livro;
import com.github.iarlo.livraria.service.ListaService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;

import java.util.List;

@Controller
@RequestMapping("/listas")
public class ListaController {
    @Autowired
    private ListaService listaService;

    // 1. Listar livros lidos
    @GetMapping("/lidos")
    public String listarLivrosLidos (Model model) {
        List<Livro> livrosLidos = listaService.listarLivrosLidos();
        model.addAttribute("livrosLidos", livrosLidos);
        return "lista-livros-lidos"; // Nome da view para exibir livros lidos
    }

    // 2. Listar livros da lista de leitura
    @GetMapping("/leitura")
    public String listarLivrosListaDeLeitura(Model model) {
        List<Livro> livrosParaLer = listaService.listarLivrosListaLeitura();
        model.addAttribute("livrosParaLer", livrosParaLer);
        return "lista-leitura"; // Nome da view para exibir lista de leitura
    }

    // 3. Adicionar livro lido
    @PostMapping("/lidos")
    public String adicionarLivroLido(@ModelAttribute Livro livro){
        listaService.adicionarLivroLido(livro);
        return "redirect:/listas/lidos";
    }
    
    // 4. Adicionar livro Ã  lista de leitura
    @PostMapping("/leitura")
    public String adicionarLivroListaDeLeitura (@ModelAttribute Livro livro){
        listaService.adicionarLivroListaLeitura(livro);
        return "redirect:/listas/leitura";
    }

}
